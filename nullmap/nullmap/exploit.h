#pragma once

typedef struct _OBJECT_ATTRIBUTES {
	ULONG           Length;
	HANDLE          RootDirectory;
	PUNICODE_STRING ObjectName;
	ULONG           Attributes;
	PVOID           SecurityDescriptor;
	PVOID           SecurityQualityOfService;
} OBJECT_ATTRIBUTES;

typedef struct _IO_STATUS_BLOCK {
	union {
		NTSTATUS Status;
		PVOID    Pointer;
	};
	ULONG_PTR Information;
} IO_STATUS_BLOCK, * PIO_STATUS_BLOCK;

__kernel_entry NTSTATUS WINAPI NtCreateIoCompletion(
	PHANDLE IoCompletionHandle,
	ACCESS_MASK DesiredAccess,
	OBJECT_ATTRIBUTES* ObjectAttributes,
	DWORD NumberOfConcurrentThreads
);


__kernel_entry NTSTATUS WINAPI NtRemoveIoCompletion(
	HANDLE IoCompletionHandle,
	PUINT_PTR KeyContext,
	PUINT_PTR ApcContext,
	PIO_STATUS_BLOCK IoStatusBlock,
	PLARGE_INTEGER Timeout
);

__kernel_entry NTSTATUS WINAPI NtSetIoCompletion(
	HANDLE IoCompletionHandle,
	UINT_PTR KeyContext,
	UINT_PTR ApcContext,
	UINT_PTR Status,
	UINT_PTR IoStatusInformation
);

__kernel_entry NTSTATUS WINAPI NtCreateFile(
	PHANDLE FileHandle,
	 ACCESS_MASK DesiredAccess,
	 OBJECT_ATTRIBUTES* ObjectAttributes,
	 PIO_STATUS_BLOCK IoStatusBlock,
	 PLARGE_INTEGER AllocationSize,
	 ULONG FileAttributes,
	 ULONG ShareAccess,
	 ULONG CreateDisposition,
	 ULONG CreateOptions,
	 PVOID EaBuffer,
	 ULONG EaLength
);

__kernel_entry NTSTATUS WINAPI NtDeviceIoControlFile(
	HANDLE  FileHandle,
	HANDLE Event,
	PVOID ApcRoutine,
	PVOID ApcContext,
	PIO_STATUS_BLOCK IoStatusBlock,
	ULONG IoControlCode,
	PVOID InputBuffer,
	ULONG InputBufferLength,
	PVOID OutputBuffer,
	ULONG OutputBufferLength
);

BOOL ExploitWrite0x1(void* targetAddress);